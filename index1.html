const SPREADSHEET_ID = "1bHStbxLFlwikvGYwmA75XGRjcea_woDwBVjgwPC7v4A";
const SHEET_NAME = "Hoja 1"; // con espacio

function doPost(e) {
  const ss = SpreadsheetApp.openById(SPREADSHEET_ID);
  const sheet = ss.getSheetByName(SHEET_NAME);

  if (!sheet) {
    return ContentService.createTextOutput(
      "ERROR: No existe la hoja '" + SHEET_NAME + "'"
    );
  }

  sheet.appendRow([
    new Date(),
    (e && e.parameter && e.parameter["Nombre"]) || "",
    (e && e.parameter && e.parameter["Asistencia"]) || "",
    (e && e.parameter && e.parameter["Total_Invitados"]) || "",
    (e && e.parameter && e.parameter["Comentarios"]) || ""
  ]);

  return ContentService.createTextOutput("OK");
}
